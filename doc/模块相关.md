### 模块相关
#### 1、dnslog服务器
```python

```
#### 2、伪造成Word文档的exe文件
```python
# python模块运行逻辑
# 1、从前端传递的数据中获取参数
# 2、调用Msf生成shellcode
# 3、将shellcode传递给c++代码,通过jinja2模板渲染实现
# 4、c++代码中实现了捆绑word和exe,点击word.exe后拷贝exe到document下并释放doc,执行exe连接Msf
```

### 权限提升
#### 1、获取目标主机补丁信息
```python
# python模块运行逻辑
# 1、从前端中获取运行模块名称 PrivilegeEscalation_EnumPatchExample_Windows.py
# 2、在Python模块中调用Msf,向msf发送参数 ['post', 'windows/gather/enum_patches', {'SESSION': 2}, False, 120]
# 3、进程对象入 XCACHE_MODULES_TASK_LIST
# 4、ModuleJobsScheduler.add_listener(self.deal_result)监控post_module_intent._thread_run的PrivilegeEscalation_EnumPatchExample_Windows.py运行完成
# 5、进入deal_result的store_executed_result, 从XCACHE_MODULES_TASK_LIST取进程对象,保存结果
```
#### 2、搜索可用cve
```python
# msf模块运行逻辑
# 1、从前端中获取运行模块名称 PrivilegeEscalation_ExploitationForPrivilegeEscalation_Windows
# 2、向msf发送参数 ['post', 'windows/manage/powershell/exec_powershell_mem', {'SESSION': 3, 'SCRIPT': 'KBCollects.ps1', 'TIMEOUT': 60}, True, 3]
# 3、msf执行KBCollects.ps1,并将被控主机的补丁数据返回, 数据发送到sub_msf_module_result_thread
# 4、进程回调 加载CVEKB.db,输出对比数据
```
#### 3、cve_2021_40449
```python
# 1、发送给msf的参数带有'exploit', 'windows/local/cve_2021_40449_api',调用Msf中的cve_2021_40449进行提权
```
#### 4、bypassuac
```python
# python模块运行逻辑 PrivilegeEscalation_BypassUserAccountControl_Windows
# 1、检测模式仅列出viper中存在的pypassuac方法,不检测
# 2、自动模式,遍历所有方法逐个执行
# 3、windows/local/bypassuac_comhijack, 调用msf, 向msf发送参数, 通过self.deal_result监控post_module_intent._thread_run执行完成
# 4、如执行成功,则上线
```
#### 5、windows system提权
```python
# msf模块运行逻辑
# 1、前端调用模块PrivilegeEscalation_ProcessInjection_Getsystem
# 2、向Msf发送参数 ['post', 'windows/escalate/getsystem_api', {'SESSION': 10, 'TECHNIQUE': 1}, True, 3]
# 3、msf返回数据到sub_msf_module_result_thread, 根据uuid到XCACHE_MODULES_TASK_LIST取进程对象, 回调
```